<!DOCTYPE html>
<html lang="uk">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>{% block title %}LLM Attack Analysis System{% endblock %}</title>

	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<!-- Font Awesome -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
	<!-- Chart.js -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<!-- Socket.IO -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>

	<style>
		:root {
			--primary-color: #2c3e50;
			--secondary-color: #3498db;
			--success-color: #27ae60;
			--warning-color: #f39c12;
			--danger-color: #e74c3c;
			--dark-color: #34495e;
			--light-color: #ecf0f1;
		}

		body {
			background-color: var(--light-color);
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
		}

		.navbar {
			background: linear-gradient(135deg, var(--primary-color), var(--dark-color));
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
		}

		.navbar-brand {
			font-weight: bold;
			color: white !important;
		}

		.nav-link {
			color: rgba(255, 255, 255, 0.9) !important;
			transition: color 0.3s ease;
		}

		.nav-link:hover {
			color: white !important;
		}

		.sidebar {
			background: white;
			min-height: calc(100vh - 76px);
			box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
			padding: 20px 0;
		}

		.sidebar .nav-link {
			color: var(--dark-color) !important;
			padding: 12px 25px;
			border-radius: 0;
			transition: all 0.3s ease;
		}

		.sidebar .nav-link:hover,
		.sidebar .nav-link.active {
			background-color: var(--secondary-color);
			color: white !important;
			transform: translateX(5px);
		}

		.sidebar .nav-link i {
			margin-right: 10px;
			width: 20px;
		}

		.main-content {
			padding: 30px;
			background: white;
			margin: 20px;
			border-radius: 10px;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
		}

		.card {
			border: none;
			border-radius: 15px;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
			transition: transform 0.3s ease, box-shadow 0.3s ease;
		}

		.card:hover {
			transform: translateY(-5px);
			box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
		}

		.card-header {
			background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
			color: white;
			border-radius: 15px 15px 0 0 !important;
			font-weight: bold;
		}

		.btn {
			border-radius: 25px;
			padding: 10px 25px;
			font-weight: 500;
			transition: all 0.3s ease;
		}

		.btn:hover {
			transform: translateY(-2px);
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
		}

		.alert {
			border-radius: 15px;
			border: none;
		}

		.badge {
			border-radius: 20px;
			padding: 8px 15px;
			font-size: 0.9em;
		}

		.table {
			border-radius: 15px;
			overflow: hidden;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
		}

		.table thead th {
			background: linear-gradient(135deg, var(--primary-color), var(--dark-color));
			color: white;
			border: none;
			font-weight: 600;
		}

		.progress {
			border-radius: 25px;
			height: 10px;
		}

		.status-indicator {
			width: 12px;
			height: 12px;
			border-radius: 50%;
			display: inline-block;
			margin-right: 8px;
		}

		.status-running {
			background-color: var(--warning-color);
		}

		.status-completed {
			background-color: var(--success-color);
		}

		.status-failed {
			background-color: var(--danger-color);
		}

		.status-stopped {
			background-color: var(--dark-color);
		}

		.metric-card {
			text-align: center;
			padding: 20px;
		}

		.metric-value {
			font-size: 2.5em;
			font-weight: bold;
			color: var(--primary-color);
		}

		.metric-label {
			color: var(--dark-color);
			font-size: 1.1em;
			margin-top: 10px;
		}

		.loading-spinner {
			display: inline-block;
			width: 20px;
			height: 20px;
			border: 3px solid #f3f3f3;
			border-top: 3px solid var(--secondary-color);
			border-radius: 50%;
			animation: spin 1s linear infinite;
		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}

		.toast-container {
			position: fixed;
			top: 20px;
			right: 20px;
			z-index: 1050;
		}

		.footer {
			background: var(--primary-color);
			color: white;
			text-align: center;
			padding: 20px;
			margin-top: 50px;
		}
	</style>

	{% block extra_css %}{% endblock %}
</head>

<body>
	<!-- Navigation -->
	<nav class="navbar navbar-expand-lg navbar-dark">
		<div class="container-fluid">
			<a class="navbar-brand" href="{{ url_for('index') }}">
				<i class="fas fa-shield-alt me-2"></i>
				LLM Attack Analysis System
			</a>

			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav ms-auto">
					<li class="nav-item">
						<a class="nav-link" href="{{ url_for('dashboard') }}">
							<i class="fas fa-tachometer-alt me-1"></i>Dashboard
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="{{ url_for('logs_page') }}">
							<i class="fas fa-list-alt me-1"></i>Logs
						</a>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<div class="container-fluid">
		<div class="row">
			<!-- Sidebar -->
			<div class="col-md-2 sidebar">
				<nav class="nav flex-column">
					<a class="nav-link {% if request.endpoint == 'index' %}active{% endif %}" href="{{ url_for('index') }}">
						<i class="fas fa-home"></i>Головна
					</a>
					<a class="nav-link {% if request.endpoint == 'dashboard' %}active{% endif %}"
						href="{{ url_for('dashboard') }}">
						<i class="fas fa-tachometer-alt"></i>Панель керування
					</a>
					<a class="nav-link {% if request.endpoint == 'attack_page' %}active{% endif %}"
						href="{{ url_for('attack_page') }}">
						<i class="fas fa-bug"></i>Генерація атак
					</a>
					<a class="nav-link {% if request.endpoint == 'defense_page' %}active{% endif %}"
						href="{{ url_for('defense_page') }}">
						<i class="fas fa-shield-alt"></i>Аналіз захисту
					</a>
					<a class="nav-link {% if request.endpoint == 'simulation_page' %}active{% endif %}"
						href="{{ url_for('simulation_page') }}">
						<i class="fas fa-play-circle"></i>Симуляція атак
					</a>
					<a class="nav-link {% if request.endpoint == 'network_page' %}active{% endif %}"
						href="{{ url_for('network_page') }}">
						<i class="fas fa-network-wired"></i>Аналіз мережі
					</a>
					<a class="nav-link {% if request.endpoint == 'logs_page' %}active{% endif %}"
						href="{{ url_for('logs_page') }}">
						<i class="fas fa-list-alt"></i>Логи системи
					</a>
				</nav>
			</div>

			<!-- Main Content -->
			<div class="col-md-10">
				<div class="main-content">
					{% block content %}{% endblock %}
				</div>
			</div>
		</div>
	</div>

	<!-- Toast Container -->
	<div class="toast-container"></div>

	<!-- Footer -->
	<footer class="footer">
		<div class="container">
			<p>&copy; 2024 LLM Attack Analysis System. Всі права захищено.</p>
		</div>
	</footer>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

	<!-- Socket.IO Connection -->
	<script>
		const socket = io();

		socket.on('connect', function () {
			console.log('Connected to server');
			showToast('Підключено до сервера', 'success');
		});

		socket.on('disconnect', function () {
			console.log('Disconnected from server');
			showToast('Відключено від сервера', 'warning');
		});

		socket.on('simulation_update', function (data) {
			console.log('Simulation update:', data);
			updateSimulationStatus(data);
		});

		// Utility functions
		function showToast(message, type = 'info') {
			const toastContainer = document.querySelector('.toast-container');
			const toast = document.createElement('div');
			toast.className = `alert alert-${type} alert-dismissible fade show`;
			toast.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;

			toastContainer.appendChild(toast);

			// Auto remove after 5 seconds
			setTimeout(() => {
				if (toast.parentNode) {
					toast.parentNode.removeChild(toast);
				}
			}, 5000);
		}

		function updateSimulationStatus(data) {
			// This will be implemented in specific pages
			console.log('Updating simulation status:', data);
		}

		function formatDateTime(dateString) {
			const date = new Date(dateString);
			return date.toLocaleString('uk-UA');
		}

		function formatDuration(seconds) {
			const minutes = Math.floor(seconds / 60);
			const remainingSeconds = seconds % 60;
			return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
		}
	</script>

	{% block extra_js %}{% endblock %}
</body>

</html>